<!--
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.

Copyright (c) 2021-present Kaleidos Ventures SL
-->
<ng-container *transloco="let t; read: 'navigation'">
  <ng-container *ngIf="(logged$ | async) === false">
    <div class="left">
      <a
        appearance="home-button"
        [attr.aria-label]="t('go_home')"
        [routerLink]="['/']"
        class="home-button"
        tuiIconButton
        icon="taiga-logo"
        type="button">
      </a>
    </div>
    <div class="accesibility-help">
      <button
        tuiButton
        (click)="scrollToMainArea()">
        {{ t('skip_to_content') }}
      </button>
    </div>
    <div class="right">
      <div class="actions">
        <a
          [routerLink]="['/login']"
          data-test="navigation-login-button"
          appearance="secondary"
          tuiButton
          type="submit">
          {{ t('log_in') }}
        </a>
        <a
          [routerLink]="['/signup']"
          data-test="navigation-create-account-button"
          appearance="primary"
          tuiButton
          type="submit">
          {{ t('create_account') }}
        </a>
      </div>
    </div>
  </ng-container>
  <ng-container *ngIf="user$ | async as user">
    <div class="left">
      <a
        appearance="home-button"
        [attr.aria-label]="t('go_home')"
        [routerLink]="['/']"
        class="home-button"
        tuiIconButton
        icon="taiga-logo"
        type="button">
      </a>
      <div class="accesibility-help">
        <button
          tuiButton
          (click)="scrollToMainArea()">
          {{ t('skip_to_content') }}
        </button>
      </div>
      <tui-hosted-dropdown
        [tuiDropdownMaxHeight]="800"
        [content]="projectsDropdown"
        [(open)]="openProjectsDropdown">
        <button
          role="menu"
          aria-haspopup="true"
          [attr.aria-expanded]="openProjectsDropdown"
          tabindex="0"
          appearance="main-nav"
          tuiButton
          icon="folder"
          type="button"
          data-test="projects-dropdown">
          {{ 'commons.projects' | transloco }}
        </button>
      </tui-hosted-dropdown>
    </div>
    <div class="right">
      <div class="actions">
        <button
          appearance="nav-icon-button"
          [attr.aria-label]="t('search')"
          tuiIconButton
          icon="search"
          type="button"></button>
        <button
          appearance="nav-icon-button"
          tuiIconButton
          [attr.aria-label]="t('discover')"
          icon="discover"
          type="button"></button>
        <button
          appearance="nav-icon-button"
          tuiIconButton
          [attr.aria-label]="t('help')"
          icon="help"
          type="button"></button>
        <tui-badged-content
          class="nav-badged-button"
          [contentTop]="24"
          colorTop="var(--color-red)"
          size="s">
          <button
            appearance="nav-icon-button"
            [attr.aria-label]="t('notification')"
            aria-describedby="aria-notifications-description"
            tuiIconButton
            icon="bell"
            type="button"></button>
        </tui-badged-content>
        <p
          id="aria-notifications-description"
          class="visually-hidden">
          {{
            t('notification_desc', {
              notifications: 24
            })
          }}
        </p>
      </div>
      <div class="separator"></div>
      <div class="avatar-holder">
        <tui-hosted-dropdown
          [content]="userDropdown"
          [(open)]="openUserDropdown">
          <button
            role="menu"
            aria-haspopup="true"
            [attr.aria-expanded]="openUserDropdown"
            tabindex="0"
            class="avatar-dropdown-button"
            [attr.aria-label]="user.fullName"
            type="button"
            data-test="user-settings">
            <tg-user-avatar
              aria-hidden="true"
              [color]="user.color"
              [rounded]="true"
              [attr.title]="user.fullName"></tg-user-avatar>
          </button>
        </tui-hosted-dropdown>
      </div>
    </div>

    <ng-template #userDropdown>
      <tg-navigation-user-dropdown
        [user]="user"
        (requestClose)="openUserDropdown = false"></tg-navigation-user-dropdown>
    </ng-template>

    <ng-template #projectsDropdown>
      <tg-navigation-projects></tg-navigation-projects>
    </ng-template>
  </ng-container>
</ng-container>
