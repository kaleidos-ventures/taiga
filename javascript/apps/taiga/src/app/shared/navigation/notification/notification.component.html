<!--
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.

Copyright (c) 2023-present Kaleidos INC
-->

<ng-container *transloco="let t">
  <div
    class="notification"
    (click)="markAsRead($event, notification)"
    [class.unread]="!notification.readAt">
    <ng-container *ngIf="notification.type === 'stories.assign'">
      <div class="notification-inner">
        <tg-user-avatar
          size="m"
          class="no-border"
          [color]="notification.content.assignedBy.color"
          [user]="notification.content.assignedBy"
          type="light"
          [rounded]="true"
          aria-hidden="true"></tg-user-avatar>

        <div class="notification-info">
          <p
            class="type"
            withInternalLink
            [innerHtml]="
            t(getTranslationKey(notification), {
              username: notification.content.assignedBy.fullName,
              story: getStoryName(notification),
              storyUrl: getStoryUrl(notification) | getUrl,
            })
          "></p>
          <p class="date">
            {{ notification.createdAt | date: 'MMMM d, y - h:mm:ss a' }}
          </p>
        </div>
      </div>
    </ng-container>
    <ng-container *ngIf="notification.type === 'stories.unassign'">
      <div class="notification-inner">
        <tg-user-avatar
          size="m"
          class="no-border"
          [color]="notification.content.unassignedBy.color"
          [user]="notification.content.unassignedBy"
          type="light"
          [rounded]="true"
          aria-hidden="true"></tg-user-avatar>

        <div class="notification-info">
          <p
            class="type"
            withInternalLink
            [innerHtml]="
            t(getTranslationKey(notification), {
              username: notification.content.unassignedBy.fullName,
              story: getStoryName(notification),
              storyUrl: getStoryUrl(notification) | getUrl,
            })
          "></p>

          <p class="date">
            {{ notification.createdAt | date: 'MMMM d, y - h:mm:ss a' }}
          </p>
        </div>
      </div>
    </ng-container>
    <ng-container *ngIf="notification.type === 'stories.status_change'">
      <div class="notification-inner">
        <tg-user-avatar
          size="m"
          class="no-border"
          [color]="notification.content.changedBy.color"
          [user]="notification.content.changedBy"
          type="light"
          [rounded]="true"
          aria-hidden="true"></tg-user-avatar>

        <div class="notification-info">
          <p
            class="type"
            withInternalLink
            [innerHtml]="
              t(getTranslationKey(notification), {
                username: notification.content.changedBy.fullName,
                story: getStoryName(notification),
                storyUrl: getStoryUrl(notification) | getUrl,
                status: notification.content.status
              })
            "></p>

          <p class="date">
            {{ notification.createdAt | date: 'MMMM d, y - h:mm:ss a' }}
          </p>
        </div>
      </div>
    </ng-container>
    <ng-container *ngIf="notification.type === 'story_comment.create'">
      <div class="notification-inner">
        <tg-user-avatar
          size="m"
          class="no-border"
          [color]="notification.content.commentedBy.color"
          [user]="notification.content.commentedBy"
          type="light"
          [rounded]="true"
          aria-hidden="true"></tg-user-avatar>

        <div class="notification-info">
          <p
            class="type"
            withInternalLink
            [innerHtml]="
              t(getTranslationKey(notification), {
                username: notification.content.commentedBy.fullName,
                story: getStoryName(notification),
                storyUrl: getStoryUrl(notification) | getUrl,
              })
            "></p>

          <p class="date">
            {{ notification.createdAt | date: 'MMMM d, y - h:mm:ss a' }}
          </p>
        </div>
      </div>
    </ng-container>
  </div>
</ng-container>
