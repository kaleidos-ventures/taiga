<!--
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.

Copyright (c) 2021-present Kaleidos Ventures SL
-->

<ng-container *transloco="let t">
  <ng-container *ngIf="variant === 'placeholder'">
    <div class="project-item-card placeholder">
      <tg-ui-avatar
        type="light"
        [color]="0"
        [name]="''">
      </tg-ui-avatar>
      <a
        tuiLink
        [routerLink]="['/new-project']"
        [queryParams]="{ workspace: workspace.id }"
        data-test="create-project-card"
        class="project-item-link">
        <ng-container *ngIf="firstProject">
          {{ t('common_project.create_first_project') }}
        </ng-container>
        <ng-container *ngIf="!firstProject">
          {{ t('common_project.create_new_project') }}
        </ng-container>
      </a>
    </div>
  </ng-container>
  <ng-container *ngIf="variant === 'project' && project">
    <div class="project-item-card">
      <div class="project-card-title">
        <tg-ui-avatar
          class="project-card-image"
          type="light"
          [color]="project.color"
          [avatarUrl]="project.logoSmall"
          [name]="project.name">
        </tg-ui-avatar>
        <a
          [routerLink]="['/project', project.id, project.slug]"
          class="project-card-link"
          data-test="project-card-name">
          {{ project.name }}
        </a>
      </div>
      <p class="project-card-description">{{ project.description }}</p>
    </div>
  </ng-container>
  <ng-container *ngIf="variant === 'invitation' && project">
    <div
      #invitationCardContainer
      data-animation="card-container">
      <button
        (click)="onRejectInvite()"
        data-test="project-reject-invite"
        class="project-reject-invite"
        tuiIconButton
        [@itemSlideOutAnimation]
        *ngIf="invitationStatus !== 'accepted'"
        appearance="us-header-button"
        [attr.aria-label]="t('commons.close')"
        [tuiHint]="t('common_project.card.close_card')"
        icon="close"
        type="button"></button>
      <div
        class="project-item-card"
        [@invitationAccepted]="animationAcceptedInvitation">
        <div
          class="card-badge-container"
          [@itemSlideOutAnimation]
          *ngIf="invitationStatus !== 'accepted'">
          <tg-ui-badge
            [label]="t('common_project.card.pending_invitation') | capitalize"
            icon="clock"
            color="gray">
          </tg-ui-badge>
        </div>
        <div class="project-card-title">
          <tg-ui-avatar
            class="project-card-image"
            type="light"
            [color]="project.color"
            [avatarUrl]="project.logoSmall"
            [name]="project.name">
          </tg-ui-avatar>
          <a
            [routerLink]="['/project', project.id, project.slug]"
            class="project-card-link"
            data-test="project-card">
            {{ project.name }}
          </a>
        </div>
        <button
          class="project-accept-invite"
          tuiButton
          [@itemSlideOutAnimation]
          data-test="project-accept-invite"
          *ngIf="invitationStatus !== 'accepted'"
          (click)="acceptInvite.next({ id: project.id, name: project.name })"
          appearance="primary"
          type="button">
          {{ t('common_project.card.accept_invite') }}
        </button>
        <p
          class="project-card-description"
          [@itemSlideOutAnimation]
          (@itemSlideOutAnimation.done)="invitationAccepted()"
          *ngIf="invitationStatus === 'accepted'">
          {{ project.description }}
        </p>
      </div>
    </div>
  </ng-container>
</ng-container>
