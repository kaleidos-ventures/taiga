{"version":3,"file":"taiga-ui-core-directives-hint.js","sources":["ng://@taiga-ui/core/directives/hint/hint.directive.ts","ng://@taiga-ui/core/directives/hint/hint.module.ts","ng://@taiga-ui/core/directives/hint/taiga-ui-core-directives-hint.ts"],"sourcesContent":["import {\n    Directive,\n    ElementRef,\n    Inject,\n    Input,\n    OnDestroy,\n    Renderer2,\n    Self,\n} from '@angular/core';\nimport {\n    tuiDefaultProp,\n    TuiDestroyService,\n    TuiHoveredService,\n    TuiObscuredService,\n    TuiParentsScrollService,\n    tuiRequiredSetter,\n} from '@taiga-ui/cdk';\nimport {AbstractTuiHint} from '@taiga-ui/core/abstract';\nimport {DESCRIBED_BY} from '@taiga-ui/core/directives/described-by';\nimport {TuiHintMode} from '@taiga-ui/core/enums';\nimport {TuiHintService} from '@taiga-ui/core/services';\nimport {PolymorpheusContent} from '@tinkoff/ng-polymorpheus';\nimport {combineLatest, of, Subject} from 'rxjs';\nimport {\n    delay,\n    distinctUntilChanged,\n    map,\n    startWith,\n    switchMap,\n    take,\n    takeUntil,\n} from 'rxjs/operators';\n\nexport const HINT_HOVERED_CLASS = '_hint_hovered';\nconst SHOW_DELAY = 500;\nconst HIDE_DELAY = 200;\n\n@Directive({\n    selector: '[tuiHint]:not(ng-container)',\n    providers: [TuiObscuredService, TuiParentsScrollService, TuiDestroyService],\n})\nexport class TuiHintDirective extends AbstractTuiHint implements OnDestroy {\n    readonly componentHovered$ = new Subject<boolean>();\n\n    @Input()\n    tuiHintId?: string;\n\n    @Input()\n    @tuiDefaultProp()\n    tuiHintHost: HTMLElement | null = null;\n\n    @Input()\n    @tuiRequiredSetter()\n    set tuiHint(value: PolymorpheusContent | null) {\n        if (!value) {\n            this.hideTooltip();\n            this.content = '';\n\n            return;\n        }\n\n        this.content = value;\n    }\n\n    constructor(\n        @Inject(Renderer2) private readonly renderer: Renderer2,\n        @Inject(ElementRef) elementRef: ElementRef<HTMLElement>,\n        @Inject(TuiHintService) hintService: TuiHintService,\n        @Inject(TuiDestroyService)\n        destroy$: TuiDestroyService,\n        @Inject(TuiObscuredService)\n        @Self()\n        obscured$: TuiObscuredService,\n        @Inject(TuiHoveredService) hoveredService: TuiHoveredService,\n    ) {\n        super(elementRef, hintService);\n\n        // @bad TODO: Use private provider\n        combineLatest(\n            hoveredService.createHovered$(elementRef.nativeElement),\n            this.componentHovered$.pipe(startWith(false)),\n        )\n            .pipe(\n                map(\n                    ([directiveHovered, componentHovered]) =>\n                        directiveHovered || componentHovered,\n                ),\n                switchMap(visible => {\n                    this.toggleClass(visible);\n\n                    return of(visible).pipe(delay(visible ? SHOW_DELAY : HIDE_DELAY));\n                }),\n                switchMap(visible =>\n                    visible && this.mode !== TuiHintMode.Overflow\n                        ? obscured$.pipe(\n                              map(obscured => !obscured),\n                              take(2),\n                          )\n                        : of(visible),\n                ),\n                distinctUntilChanged(),\n                takeUntil(destroy$),\n            )\n            .subscribe({\n                next: visible => {\n                    if (visible) {\n                        this.showTooltip();\n                    } else {\n                        this.hideTooltip();\n                    }\n                },\n                complete: () => {\n                    this.hideTooltip();\n                },\n            });\n\n        this.hintService.register(this);\n    }\n\n    get id(): string | null {\n        return this.tuiHintId ? this.tuiHintId + DESCRIBED_BY : null;\n    }\n\n    get host(): HTMLElement {\n        return this.tuiHintHost ? this.tuiHintHost : this.elementRef.nativeElement;\n    }\n\n    getElementClientRect(): ClientRect {\n        return this.host.getBoundingClientRect();\n    }\n\n    ngOnDestroy() {\n        this.hintService.unregister(this);\n        this.hideTooltip();\n    }\n\n    protected showTooltip() {\n        if (this.content === '') {\n            return;\n        }\n\n        this.toggleClass(true);\n        this.hintService.add(this);\n    }\n\n    protected hideTooltip() {\n        this.toggleClass(false);\n        this.hintService.remove(this);\n    }\n\n    private toggleClass(add: boolean) {\n        if (add) {\n            this.renderer.addClass(this.elementRef.nativeElement, HINT_HOVERED_CLASS);\n        } else {\n            this.renderer.removeClass(this.elementRef.nativeElement, HINT_HOVERED_CLASS);\n        }\n    }\n}\n","import {NgModule} from '@angular/core';\nimport {TuiHintDirective} from './hint.directive';\n\n@NgModule({\n    declarations: [TuiHintDirective],\n    exports: [TuiHintDirective],\n})\nexport class TuiHintModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}